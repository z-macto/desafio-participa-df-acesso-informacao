<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Resultados dos Testes em Massa</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light d-flex flex-column min-vh-100">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
      <a class="navbar-brand" href="/">Detector de informações pessoais</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="/">Página Principal</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/testes">Testes em Massa</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Conteúdo -->
  <div class="container mt-4 flex-grow-1">
    <h2 class="mb-4">Resultados dos Testes em Massa</h2>

    <p><strong>Total de entradas:</strong> {{ resumo.TotalEntradas }}</p>
    <p><strong>Válidos:</strong> {{ resumo.Validos }}</p>
    <p><strong>Inválidos:</strong> {{ resumo.Invalidos }}</p>

    <table class="table table-bordered mt-4">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>Status</th>
          <th>Validação</th>
          <th>Texto</th>
          <th>Motivo</th>
          <th>Bloqueio</th> <!-- nova coluna -->
        </tr>
      </thead>
      <tbody>
        {% for r in resumo.Resultados %}
        <tr class="{% if r.Status == 'SIM' %}table-success{% else %}table-danger{% endif %}">
          <td>{{ loop.index }}</td>
          <td>{{ r.Status }}</td>
          <td>{{ r.Validacao }}</td>
          <td>{{ r.Retorno }}</td>
          <td>{{ r.Motivo or '' }}</td>
          <td>
            {% if r.Motivo_bloqueou %}
              <ul class="mb-0">
                {% for item in r.Motivo_bloqueou %}
                  <li>
                    <span class="badge bg-danger">Expressão</span>
                    <strong>{{ item.expressao }}</strong>
                    <span class="badge bg-warning text-dark">Termo inválido</span>
                    <strong>{{ item.termo_invalido }}</strong>
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Rodapé -->
  <footer class="bg-primary text-white text-center py-3 mt-auto">
    Projeto LLGGDD 1.0
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
